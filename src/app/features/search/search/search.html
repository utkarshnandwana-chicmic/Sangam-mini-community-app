<div class="search-container">
  <div class="search-input-wrapper">
    <span class="search-icon">
      <svg fill="#8e8e8e" height="16" viewBox="0 0 24 24" width="16"><path d="M19 10.5A8.5 8.5 0 1110.5 2a8.5 8.5 0 018.5 8.5z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"></path><line fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" x1="16.511" x2="22" y1="16.511" y2="22"></line></svg>
    </span>
    <input
      type="text"
      placeholder="Search"
      [formControl]="searchControl"
      class="search-input"
    />
    <button *ngIf="searchControl.value" class="clear-btn" (click)="searchControl.setValue('')">✕</button>
  </div>

  <div class="results-area">
    <div *ngIf="searchControl.value.length >= 1">
      <div *ngIf="loading()" class="loading-state">Searching...</div>
      
      <div *ngFor="let user of users()" (click)="selectUser(user)" class="search-item">
        <div class="avatar-container">
          <img [src]="user.profilePicture | imageUrl" class="user-avatar" />
        </div>
        <div class="user-info">
          <span class="username">{{ user.userName }}</span>
          <span class="full-name">{{ user.name }}</span>
        </div>
      </div>
    </div>

    <div *ngIf="!searchControl.value" class="recent-section">
      <div class="recent-header">
        <span class="title">Recent</span>
        <button class="clear-all" *ngIf="searches().length > 0">Clear all</button>
      </div>

      <div *ngFor="let search of searches()" class="search-item">
        <div class="search-history-icon">
          <svg fill="currentColor" height="20" viewBox="0 0 24 24" width="20"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm1-13h-2v6l5.25 3.15.75-1.23-4.5-2.67V7z"/></svg>
        </div>
        <div class="user-info" (click)="selectRecent(search)">
          <span class="username">{{ search.text }}</span>
        </div>
        <button class="delete-btn" (click)="delete(search)">✕</button>
      </div>

      <div *ngIf="searches().length === 0" class="empty-recent">
        No recent searches.
      </div>
    </div>
  </div>
</div>